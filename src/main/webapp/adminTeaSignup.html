<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>管理员查询教练注册申请</title>
    <link rel="stylesheet" href="plugins/layui/css/layui.css" media="all"/>
    <link rel="stylesheet" href="css/global.css" media="all">
    <link rel="stylesheet" href="plugins/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/table.css"/>
</head>

<body>
<script src="js2/jquery-3.3.1.min.js"></script>
<div class="admin-main">

    <fieldset class="layui-elem-field">
        <legend>教练注册申请</legend>

        <div class="layui-field-box layui-form">
            <table class="layui-table admin-table">
                <thead>
                <tr style="width: 30px">
                    <!--<th style="width: 30px;"><input type="checkbox" lay-filter="allselector" lay-skin="primary"></th>-->
                    <th style="text-align: center">id</th>
                    <th style="text-align: center">姓名</th>
                    <th style="text-align: center">身份证</th>
                    <th style="text-align: center">邮箱</th>
                    <th colspan="2" style="text-align: center">审核</th>
                </tr>
                </thead>
                <tbody id="content" style="align-content: normal">

                </tbody>
            </table>
        </div>
    </fieldset>

    <div class="admin-table-page">
        <div id="paged" class="page">
        </div>
    </div>
</div>

<script>
    $(function () {
        $.ajax({
            type: "POST",
            url: "/admin/findRegisterTea",
            dataType: "json",
            contentType: "application/json",
            success: function (result) {
                var data = result.data;
                for (var item of data) {
                    var card = item.card.toString().substr(0, 14);
                    $("#content").append(
                        `<tr style="text-align: center" id="${item.card}">
                    <td style="text-align: center">${item.id}</td>
                    <td style="text-align: center">${item.name}</td>
                    <td style="text-align: center">${card}xxxx</td>
                    <td style="text-align: center">${item.email}</td>
                    <td style="text-align: center"><button type="button" value="2" class="layui-btn-normal layui-btn-radius" onclick="accept(this)">通过</button></td>
                    <td style="text-align: center"><button type="button" value="3" class="layui-btn-danger layui-btn-radius" onclick="accept(this)">拒绝</button></td>
                    </tr>`
                    );
                }

            }
        })
    })


    function accept(obj) {
        var identity = $(obj).val();
        var teaCard = $(obj).parent().parent().attr("id");
        $.ajax({
            type: "GET",
            url: "/admin/accept?card=" + teaCard + "&identity=" + identity,
            dataType: "json",
            contentType: "application/json",
            success: function (data) {
                if (data.status === "1") {
                    alert("审核成功");
                    $(location).attr('href', data.data);
                } else {
                    alert(data.msg);
                }
            }
        })
    }

</script>

</body>

</html>